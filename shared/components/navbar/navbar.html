<nav class="navbar navbar-expand-lg bg-light shadow-sm sticky-top custom-navbar">
  <div class="container-fluid px-4">

    <!-- Brand Logo -->
    <a class="navbar-brand d-flex align-items-center text-dark fw-bold fs-3 me-4 smartkart-logo" routerLink="/home">
      <div class="logo-icon d-flex align-items-center justify-content-center me-2">
        <span class="initial">S</span>
      </div>
      <span class="logo-text">Smart<span class="text-primary">Kart</span></span>
    </a>

    <!-- Toggler -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarAmazonUp"
      aria-controls="navbarAmazonUp" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarAmazonUp">

      <!-- Location -->
      <div class="d-none d-lg-flex align-items-center me-4 location-info">
        <i class="bi bi-geo-alt text-gradient fs-5 me-1"></i>
        <div>
          <small class="text-muted">Deliver to</small><br>
          <span class="fw-semibold text-dark">{{ userLocation }}</span>
        </div>
      </div>

      <!-- Search Bar -->
      <form class="d-flex flex-grow-1 mx-3 search-area" (submit)="onSearch(searchInput.value); $event.preventDefault()">
        <div class="input-group search-bar w-100 rounded shadow-sm">
          <span class="input-group-text bg-white border-end-0">
            <i class="bi bi-search text-primary"></i>
          </span>
          <input type="text" #searchInput class="form-control border-start-0" placeholder="Search products...">
          <button class="btn btn-gradient" type="submit">Search</button>
        </div>
      </form>

      <!-- Right Side -->
      <ul class="navbar-nav ms-lg-3 align-items-lg-center gap-3">

        <!-- Login/Register or User Dropdown -->
        <li class="nav-item dropdown" *ngIf="!isLoggedIn">
          <a class="nav-link dropdown-toggle fw-bold text-dark px-3 py-2 border border-light rounded-3 bg-white shadow-sm"
            href="#" role="button" id="loginDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            Hello, Guest
          </a>
          <ul class="dropdown-menu dropdown-menu-end p-3 shadow-lg border-0 rounded-4 animate-fadein"
              aria-labelledby="loginDropdown" style="min-width: 270px;">
            <div class="d-grid gap-2">
              <a class="btn btn-gradient fw-semibold rounded-3" routerLink="/auth/login">Sign in</a>
              <small class="text-muted text-center">
                New here?
                <a class="text-decoration-none fw-semibold text-gradient" routerLink="/auth/register">Register now</a>
              </small>
            </div>
          </ul>
        </li>

        <!-- Logged-In User -->
        <li class="nav-item dropdown" *ngIf="isLoggedIn">
          <a class="nav-link dropdown-toggle fw-bold text-dark px-3 py-2 border border-light rounded-3 bg-white shadow-sm"
             href="#" role="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            Hello, {{ userName }}
          </a>
          <ul class="dropdown-menu dropdown-menu-end p-3 shadow-lg border-0 rounded-4 animate-fadein"
              aria-labelledby="userDropdown" style="min-width: 270px;">
            <div class="d-grid gap-2">
              <button class="btn btn-outline-danger fw-semibold rounded-3" (click)="logout()">Logout</button>
            </div>
          </ul>
        </li>

        <!-- Orders -->
        <li class="nav-item text-end">
          <small class="text-muted">Returns</small><br>
          <a routerLink="/orders" class="fw-bold text-dark nav-link p-0 hover-underline">Orders</a>
        </li>

        <!-- Cart -->
        <li class="nav-item">
          <a routerLink="/cart" class="btn btn-outline-dark position-relative cart-btn rounded-pill px-3">
            <i class="bi bi-cart fs-5 me-1"></i> Cart
            <span *ngIf="cartCount > 0" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
              {{ cartCount }}
            </span>
          </a>
        </li>

      </ul>
    </div>
  </div>
</nav>
